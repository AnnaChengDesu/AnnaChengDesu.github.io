<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>08-Module Pattern-设计模式学习-vanilla篇 | Anna.me</title><meta name=keywords content="Javascript&#34;"><meta name=description content="Module Pattern 模块模式 随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。
除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。
ES2015 Modules ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。
让我们看一个名为 math.js 的模块示例，其中包含数学函数。
function add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; } 函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。
但是，我们不仅仅想在 math.js 文件中使用这些函数，我们希望能够在 index.js 文件中引用它们。但是直接在 index.js 文件内调用会抛出错误： index.js 文件中没有名为 add 、 subtract 、 multiply 或 square 。
为了使 math.js 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 export 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 export 关键字。在这种情况下，我们需要在每个函数前面添加 export 关键字，因为 index."><meta name=author content="Anna.me"><link rel=canonical href=https://annachengdesu.github.io/post/patterns/module/><link crossorigin=anonymous href=/assets/css/stylesheet.f2da42eb72c6ac4b82b92c21716a96ae77ab6a2505a713280483eee56482a913.css integrity="sha256-8tpC63LGrEuCuSwhcWqWrneraiUFpxMoBIPu5WSCqRM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://annachengdesu.github.io/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://annachengdesu.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://annachengdesu.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://annachengdesu.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://annachengdesu.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="08-Module Pattern-设计模式学习-vanilla篇"><meta property="og:description" content="Module Pattern 模块模式 随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。
除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。
ES2015 Modules ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。
让我们看一个名为 math.js 的模块示例，其中包含数学函数。
function add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; } 函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。
但是，我们不仅仅想在 math.js 文件中使用这些函数，我们希望能够在 index.js 文件中引用它们。但是直接在 index.js 文件内调用会抛出错误： index.js 文件中没有名为 add 、 subtract 、 multiply 或 square 。
为了使 math.js 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 export 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 export 关键字。在这种情况下，我们需要在每个函数前面添加 export 关键字，因为 index."><meta property="og:type" content="article"><meta property="og:url" content="https://annachengdesu.github.io/post/patterns/module/"><meta property="og:image" content="https://annachengdesu.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-08-04T19:46:32+08:00"><meta property="article:modified_time" content="2023-08-04T19:46:32+08:00"><meta property="og:site_name" content="Anna.me"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://annachengdesu.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="08-Module Pattern-设计模式学习-vanilla篇"><meta name=twitter:description content="Module Pattern 模块模式 随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。
除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。
ES2015 Modules ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。
让我们看一个名为 math.js 的模块示例，其中包含数学函数。
function add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; } 函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。
但是，我们不仅仅想在 math.js 文件中使用这些函数，我们希望能够在 index.js 文件中引用它们。但是直接在 index.js 文件内调用会抛出错误： index.js 文件中没有名为 add 、 subtract 、 multiply 或 square 。
为了使 math.js 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 export 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 export 关键字。在这种情况下，我们需要在每个函数前面添加 export 关键字，因为 index."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://annachengdesu.github.io/post/"},{"@type":"ListItem","position":2,"name":"08-Module Pattern-设计模式学习-vanilla篇","item":"https://annachengdesu.github.io/post/patterns/module/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"08-Module Pattern-设计模式学习-vanilla篇","name":"08-Module Pattern-设计模式学习-vanilla篇","description":"Module Pattern 模块模式 随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。\n除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。\nES2015 Modules ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。\n让我们看一个名为 math.js 的模块示例，其中包含数学函数。\nfunction add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; } 函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。\n但是，我们不仅仅想在 math.js 文件中使用这些函数，我们希望能够在 index.js 文件中引用它们。但是直接在 index.js 文件内调用会抛出错误： index.js 文件中没有名为 add 、 subtract 、 multiply 或 square 。\n为了使 math.js 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 export 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 export 关键字。在这种情况下，我们需要在每个函数前面添加 export 关键字，因为 index.","keywords":["Javascript\""],"articleBody":"Module Pattern 模块模式 随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。\n除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。\nES2015 Modules ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。\n让我们看一个名为 math.js 的模块示例，其中包含数学函数。\nfunction add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; } 函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。\n但是，我们不仅仅想在 math.js 文件中使用这些函数，我们希望能够在 index.js 文件中引用它们。但是直接在 index.js 文件内调用会抛出错误： index.js 文件中没有名为 add 、 subtract 、 multiply 或 square 。\n为了使 math.js 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 export 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 export 关键字。在这种情况下，我们需要在每个函数前面添加 export 关键字，因为 index.js 应该可以访问所有四个函数。\nexport function add(x, y) { return x + y; } export function multiply(x) { return x * 2; } export function subtract(x, y) { return x - y; } export function square(x) { return x * x; } 但仅从模块导出值并不足以使它们对所有文件公开可用。为了能够使用从模块导出的值，必须将它们显式导入到需要引用的文件中。\n必须使用 import 关键字导入 index.js 文件顶部的值。为了让 javascript 知道我们要从哪个模块导入这些函数，我们需要添加一个 from 值和模块的相对路径。\nimport { add, multiply, subtract, square } from \"./math.js\"; 拥有模块的一大好处是我们只能访问使用 export 关键字显式导出的值。我们未使用 export 关键字显式导出的值仅在该模块中可用。\n让我们创建一个只能在 math.js 文件中引用的值，称为 privateValue 。\nmath.js\nconst privateValue = \"This is a value private to the module!\"; index.js\nimport { add, multiply, subtract, square } from \"./math.js\"; console.log(privateValue); /* Error: privateValue is not defined */ 通过将值保持为模块私有，可以降低意外污染全局范围的风险。\n有时，导出的名称可能会与本地值发生冲突。\nmport { add, multiply, subtract, square } from \"./math.js\"; function add(...args) { return args.reduce((acc, cur) =\u003e cur + acc); } /* Error: add has already been declared */ function multiply(...args) { return args.reduce((acc, cur) =\u003e cur * acc); } /* Error: multiply has already been declared */ 在本例中，我们在 index.js 中有名为 add 和 multiply 的函数。如果导入具有相同名称的值，最终会导致命名冲突，不过我们可以使用 as 关键字重命名导入的值。\n让我们将导入的 add 和 multiply 函数重命名为 addValues 和 multiplyValues 。\nimport { add as addValues, multiply as multiplyValues, subtract, square } from \"./math.js\"; function add(...args) { return args.reduce((acc, cur) =\u003e cur + acc); } function multiply(...args) { return args.reduce((acc, cur) =\u003e cur * acc); } /* From math.js module */ addValues(7, 8); multiplyValues(8, 9); subtract(10, 3); square(3); /* From index.js file */ add(8, 9, 2, 10); multiply(8, 9, 2, 10); 除了命名导出（即仅使用 export 关键字定义的导出）之外，您还可以使用默认导出。每个模块只能有一个默认导出。\n让我们将 add 函数设为默认导出，并将其他函数保留为命名导出。我们可以通过在值前面添加 export default 来导出默认值。\nexport default function add(x, y) { return x + y; } export function multiply(x) { return x * 2; } export function subtract(x, y) { return x - y; } export function square(x) { return x * x; } 命名导出和默认导出之间的区别在于从模块导出值的方式，有效地改变了我们导入值的方式。\n前面我们必须使用括号来命名导出： import { module } from 'module' 。使用默认导出，我们可以导入不带括号的值： import module from 'module' 。\nimport add, { multiply, subtract, square } from \"./math.js\"; add(7, 8); multiply(8, 9); subtract(10, 3); square(3); 由于 JavaScript 知道该值始终是默认导出的值，因此我们可以为导入的默认值指定另一个名称，而不是导出时使用的名称。例如，我们可以将其称为 addValues ，而不是使用名称 add 导入 add 函数。因为 JavaScript 知道您正在导入默认导出。\nimport addValues, { multiply, subtract, square } from \"./math.js\"; addValues(7, 8); multiply(8, 9); subtract(10, 3); square(3); 我们还可以通过使用星号 * 并给出我们想要导入模块的名称来导入模块中的所有导出，即所有命名导出和默认导出。导入的值等于包含所有导入值的对象。假设我想将整个模块导入为 math 。\nimport * as math from \"./math.js\"; import * as math from \"./math.js\"; math.default(7, 8); math.multiply(8, 9); math.subtract(10, 3); math.square(3); 在本例中，我们将从模块导入所有导出。执行此操作时要小心，因为您最终可能会导入不必要的值。\n使用 * 仅导入所有导出的值。模块私有的值在导入模块的文件中仍然不可用，除非您显式导出它们。\nDynamic import 动态导入 当导入文件顶部的所有模块时，所有模块都会先于文件的其余部分加载。在某些情况下，我们只需要根据某种条件导入一个模块。通过动态导入，我们可以按需导入模块。\nimport(\"module\").then((module) =\u003e { module.default(); module.namedExport(); }); // Or with async/await (async () =\u003e { const module = await import(\"module\"); module.default(); module.namedExport(); })(); 让我们动态导入前面段落中使用的 math.js 示例。\n仅当用户单击按钮时，该模块才会加载。\nconst button = document.getElementById(\"btn\"); button.addEventListener(\"click\", () =\u003e { import(\"./math.js\").then((module) =\u003e { console.log(\"Add: \", module.add(1, 2)); console.log(\"Multiply: \", module.multiply(3, 2)); const button = document.getElementById(\"btn\"); button.innerHTML = \"Check the console\"; }); }); /*************************** */ /**** Or with async/await ****/ /*************************** */ // button.addEventListener(\"click\", async () =\u003e { // const module = await import(\"./math.js\"); // console.log(\"Add: \", module.add(1, 2)); // console.log(\"Multiply: \", module.multiply(3, 2)); // }); 通过动态导入模块，我们可以减少页面加载时间。我们只需在用户需要时加载、解析和编译用户真正需要的代码。\n除了能够按需导入模块之外， import() 函数还可以接收表达式。它允许我们传递模板文字，以便根据给定值动态加载模块。\nimport moment from \"moment\"; export const getCurrentTime = () =\u003e { const date = moment().format(\"MMMM Do YYYY, h:mm:ss a\"); return `Currently, it is ${date}`; }; export const getCurrentDay = () =\u003e { const day = moment().format(\"dddd\"); return `It is ${day} today`; }; import React from \"react\"; export function Date() { const [currentTime, setCurrentTime] = React.useState(\"\"); const [currentDay, setCurrentDay] = React.useState(\"\"); async function loadDates() { const module = await import(\"../utils/date\"); setCurrentTime(module.getCurrentTime()); setCurrentDay(module.getCurrentDay()); } return currentTime \u0026\u0026 currentDay ? ( \u003cdiv\u003e \u003cp\u003e{currentTime}\u003c/p\u003e \u003cp\u003e{currentDay}\u003c/p\u003e \u003c/div\u003e ) : ( \u003cbutton onClick={loadDates}\u003eClick to load dates\u003c/button\u003e ); } 在上面的示例中，仅当用户单击“Click to load dates”按钮时才会导入 date.js 模块。 date.js 模块导入第三方 moment 模块，该模块仅在 date.js 模块加载时导入。如果用户不需要显示日期，我们可以完全避免加载这个第三方库。\n用户单击“单击加载图像”按钮后，将加载每个图像。图像是本地 .png 文件，根据我们传递给字符串的 num 值加载。\nconst res = await import(`../assets/dog${num}.png`); 这样，我们就不再依赖于硬编码的模块路径。它为您根据用户输入、从外部源接收的数据、函数结果等导入模块的方式增加了灵活性。\nSummary 通过模块模式，我们可以封装不应该公开的部分代码。这可以防止意外的名称冲突和全局范围污染，从而降低使用多个依赖项和命名空间的风险。为了能够在所有 JavaScript 运行时中使用 ES2015 Module，需要通过类似 Babel 这样的转译器进行转译。\n","wordCount":"656","inLanguage":"en","datePublished":"2023-08-04T19:46:32+08:00","dateModified":"2023-08-04T19:46:32+08:00","author":{"@type":"Person","name":"Anna.me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://annachengdesu.github.io/post/patterns/module/"},"publisher":{"@type":"Organization","name":"Anna.me","logo":{"@type":"ImageObject","url":"https://annachengdesu.github.io/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://annachengdesu.github.io/ accesskey=h title="Anna.me (Alt + H)">Anna.me</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://annachengdesu.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://annachengdesu.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://annachengdesu.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://annachengdesu.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://annachengdesu.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://annachengdesu.github.io/post/>Posts</a></div><h1 class=post-title>08-Module Pattern-设计模式学习-vanilla篇</h1><div class=post-meta><span title='2023-08-04 19:46:32 +0800 CST'>August 4, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;656 words&nbsp;·&nbsp;Anna.me</div></header><div class=post-content><h1 id=module-pattern-模块模式>Module Pattern 模块模式<a hidden class=anchor aria-hidden=true href=#module-pattern-模块模式>#</a></h1><p>随着应用程序和代码库的增长，保持代码的可维护性和独立性变得越来越重要。模块模式使得代码分割成更小的、可重用的部分。</p><p>除了此之外，模块还允许您将文件中的某些值保持为私有。默认情况下，模块内的声明的范围到该模块。如果我们不显式导出某个值，则该值在该模块之外不可用。这降低了代码库其他部分中声明的值发生名称冲突的风险，因为这些值在全局范围内不可用。</p><h2 id=es2015-modules>ES2015 Modules<a hidden class=anchor aria-hidden=true href=#es2015-modules>#</a></h2><p>ES2015 引入了内置 JavaScript 模块。模块是包含 JavaScript 代码的文件，与普通脚本相比，其行为存在一些差异。</p><p>让我们看一个名为 <code>math.js</code> 的模块示例，其中包含数学函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>multiply</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>subtract</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>-</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>square</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>函数允许用户进行加法、乘法、减法以及获取他们传递的值的平方。</p><p>但是，我们不仅仅想在 <code>math.js</code> 文件中使用这些函数，我们希望能够在 <code>index.js</code> 文件中引用它们。但是直接在 <code>index.js</code> 文件内调用会抛出错误： <code>index.js</code> 文件中没有名为 <code>add</code> 、 <code>subtract</code> 、 <code>multiply</code> 或 <code>square</code> 。</p><p>为了使 <code>math.js</code> 中的函数可用于其他文件，我们首先必须将它们导出。为了从模块导出代码，我们可以使用 <code>export</code> 关键字。导出函数的一种方法是使用命名导出：我们只需在可公开的部分前面添加 <code>export</code> 关键字。在这种情况下，我们需要在每个函数前面添加 <code>export</code> 关键字，因为 <code>index.js</code> 应该可以访问所有四个函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>multiply</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>subtract</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>-</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>square</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>但仅从模块导出值并不足以使它们对所有文件公开可用。为了能够使用从模块导出的值，必须将它们显式导入到需要引用的文件中。</p><p>必须使用 <code>import</code> 关键字导入 <code>index.js</code> 文件顶部的值。为了让 javascript 知道我们要从哪个模块导入这些函数，我们需要添加一个 <code>from</code> 值和模块的相对路径。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>add</span><span class=p>,</span> <span class=nx>multiply</span><span class=p>,</span> <span class=nx>subtract</span><span class=p>,</span> <span class=nx>square</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span></code></pre></div><p>拥有模块的一大好处是我们只能访问使用 <code>export</code> 关键字显式导出的值。我们未使用 <code>export</code> 关键字显式导出的值仅在该模块中可用。</p><p>让我们创建一个只能在 <code>math.js</code> 文件中引用的值，称为 <code>privateValue</code> 。</p><p>math.js</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>privateValue</span> <span class=o>=</span> <span class=s2>&#34;This is a value private to the module!&#34;</span><span class=p>;</span>
</span></span></code></pre></div><p>index.js</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>add</span><span class=p>,</span> <span class=nx>multiply</span><span class=p>,</span> <span class=nx>subtract</span><span class=p>,</span> <span class=nx>square</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>privateValue</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cm>/* Error: privateValue is not defined */</span>
</span></span></code></pre></div><p>通过将值保持为模块私有，可以降低意外污染全局范围的风险。</p><p>有时，导出的名称可能会与本地值发生冲突。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>mport</span> <span class=p>{</span> <span class=nx>add</span><span class=p>,</span> <span class=nx>multiply</span><span class=p>,</span> <span class=nx>subtract</span><span class=p>,</span> <span class=nx>square</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>add</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>args</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>cur</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>cur</span> <span class=o>+</span> <span class=nx>acc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=cm>/* Error: add has  already been declared */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>multiply</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>args</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>cur</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>cur</span> <span class=o>*</span> <span class=nx>acc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Error: multiply has already been declared */</span>
</span></span></code></pre></div><p>在本例中，我们在 <code>index.js</code> 中有名为 <code>add</code> 和 <code>multiply</code> 的函数。如果导入具有相同名称的值，最终会导致命名冲突，不过我们可以使用 <code>as</code> 关键字重命名导入的值。</p><p>让我们将导入的 <code>add</code> 和 <code>multiply</code> 函数重命名为 <code>addValues</code> 和 <code>multiplyValues</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>add</span> <span class=nx>as</span> <span class=nx>addValues</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>multiply</span> <span class=nx>as</span> <span class=nx>multiplyValues</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>subtract</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>square</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>add</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>args</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>cur</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>cur</span> <span class=o>+</span> <span class=nx>acc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>multiply</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>args</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>cur</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>cur</span> <span class=o>*</span> <span class=nx>acc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* From math.js module */</span>
</span></span><span class=line><span class=cl><span class=nx>addValues</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>multiplyValues</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>subtract</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>square</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* From index.js file */</span>
</span></span><span class=line><span class=cl><span class=nx>add</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>multiply</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span></code></pre></div><p>除了命名导出（即仅使用 <code>export</code> 关键字定义的导出）之外，您还可以使用默认导出。每个模块只能有一个默认导出。</p><p>让我们将 <code>add</code> 函数设为默认导出，并将其他函数保留为命名导出。我们可以通过在值前面添加 <code>export default</code> 来导出默认值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>multiply</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>subtract</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>-</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>square</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>*</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>命名导出和默认导出之间的区别在于从模块导出值的方式，有效地改变了我们导入值的方式。</p><p>前面我们必须使用括号来命名导出： <code>import { module } from 'module'</code> 。使用默认导出，我们可以导入不带括号的值： <code>import module from 'module'</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>add</span><span class=p>,</span> <span class=p>{</span> <span class=nx>multiply</span><span class=p>,</span> <span class=nx>subtract</span><span class=p>,</span> <span class=nx>square</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>add</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>multiply</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>subtract</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>square</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span></code></pre></div><p>由于 JavaScript 知道该值始终是默认导出的值，因此我们可以为导入的默认值指定另一个名称，而不是导出时使用的名称。例如，我们可以将其称为 <code>addValues</code> ，而不是使用名称 <code>add</code> 导入 <code>add</code> 函数。因为 JavaScript 知道您正在导入默认导出。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>addValues</span><span class=p>,</span> <span class=p>{</span> <span class=nx>multiply</span><span class=p>,</span> <span class=nx>subtract</span><span class=p>,</span> <span class=nx>square</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>addValues</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>multiply</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>subtract</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>square</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span></code></pre></div><p>我们还可以通过使用星号 <code>*</code> 并给出我们想要导入模块的名称来导入模块中的所有导出，即所有命名导出和默认导出。导入的值等于包含所有导入值的对象。假设我想将整个模块导入为 <code>math</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=o>*</span> <span class=nx>as</span> <span class=nx>math</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=o>*</span> <span class=nx>as</span> <span class=nx>math</span> <span class=nx>from</span> <span class=s2>&#34;./math.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>math</span><span class=p>.</span><span class=k>default</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>math</span><span class=p>.</span><span class=nx>multiply</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>math</span><span class=p>.</span><span class=nx>subtract</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>math</span><span class=p>.</span><span class=nx>square</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span></code></pre></div><p>在本例中，我们将从模块导入所有导出。执行此操作时要小心，因为您最终可能会导入不必要的值。</p><p>使用 <code>*</code> 仅导入所有导出的值。模块私有的值在导入模块的文件中仍然不可用，除非您显式导出它们。</p><h2 id=dynamic-import-动态导入>Dynamic import 动态导入<a hidden class=anchor aria-hidden=true href=#dynamic-import-动态导入>#</a></h2><p>当导入文件顶部的所有模块时，所有模块都会先于文件的其余部分加载。在某些情况下，我们只需要根据某种条件导入一个模块。通过动态导入，我们可以按需导入模块。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span><span class=p>(</span><span class=s2>&#34;module&#34;</span><span class=p>).</span><span class=nx>then</span><span class=p>((</span><span class=nx>module</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>module</span><span class=p>.</span><span class=k>default</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>module</span><span class=p>.</span><span class=nx>namedExport</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Or with async/await
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>module</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=s2>&#34;module&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>module</span><span class=p>.</span><span class=k>default</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>module</span><span class=p>.</span><span class=nx>namedExport</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span></code></pre></div><p>让我们动态导入前面段落中使用的 <code>math.js</code> 示例。</p><p>仅当用户单击按钮时，该模块才会加载。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>button</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;btn&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>button</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span><span class=p>(</span><span class=s2>&#34;./math.js&#34;</span><span class=p>).</span><span class=nx>then</span><span class=p>((</span><span class=nx>module</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Add: &#34;</span><span class=p>,</span> <span class=nx>module</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Multiply: &#34;</span><span class=p>,</span> <span class=nx>module</span><span class=p>.</span><span class=nx>multiply</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>button</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;btn&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>button</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s2>&#34;Check the console&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*************************** */</span>
</span></span><span class=line><span class=cl><span class=cm>/**** Or with async/await ****/</span>
</span></span><span class=line><span class=cl><span class=cm>/*************************** */</span>
</span></span><span class=line><span class=cl><span class=c1>// button.addEventListener(&#34;click&#34;, async () =&gt; {
</span></span></span><span class=line><span class=cl><span class=c1>//   const module = await import(&#34;./math.js&#34;);
</span></span></span><span class=line><span class=cl><span class=c1>//   console.log(&#34;Add: &#34;, module.add(1, 2));
</span></span></span><span class=line><span class=cl><span class=c1>//   console.log(&#34;Multiply: &#34;, module.multiply(3, 2));
</span></span></span><span class=line><span class=cl><span class=c1>// });
</span></span></span></code></pre></div><p>通过动态导入模块，我们可以减少页面加载时间。我们只需在用户需要时加载、解析和编译用户真正需要的代码。</p><p>除了能够按需导入模块之外， <code>import()</code> 函数还可以接收表达式。它允许我们传递模板文字，以便根据给定值动态加载模块。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>moment</span> <span class=nx>from</span> <span class=s2>&#34;moment&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>getCurrentTime</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>date</span> <span class=o>=</span> <span class=nx>moment</span><span class=p>().</span><span class=nx>format</span><span class=p>(</span><span class=s2>&#34;MMMM Do YYYY, h:mm:ss a&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=sb>`Currently, it is </span><span class=si>${</span><span class=nx>date</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>getCurrentDay</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>day</span> <span class=o>=</span> <span class=nx>moment</span><span class=p>().</span><span class=nx>format</span><span class=p>(</span><span class=s2>&#34;dddd&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=sb>`It is </span><span class=si>${</span><span class=nx>day</span><span class=si>}</span><span class=sb> today`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nb>Date</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>currentTime</span><span class=p>,</span> <span class=nx>setCurrentTime</span><span class=p>]</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>useState</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>currentDay</span><span class=p>,</span> <span class=nx>setCurrentDay</span><span class=p>]</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>useState</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=kd>function</span> <span class=nx>loadDates</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>module</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=s2>&#34;../utils/date&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setCurrentTime</span><span class=p>(</span><span class=nx>module</span><span class=p>.</span><span class=nx>getCurrentTime</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=nx>setCurrentDay</span><span class=p>(</span><span class=nx>module</span><span class=p>.</span><span class=nx>getCurrentDay</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>currentTime</span> <span class=o>&amp;&amp;</span> <span class=nx>currentDay</span> <span class=o>?</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>currentTime</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>currentDay</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span> <span class=o>:</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>loadDates</span><span class=p>}</span><span class=o>&gt;</span><span class=nx>Click</span> <span class=nx>to</span> <span class=nx>load</span> <span class=nx>dates</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>在上面的示例中，仅当用户单击“Click to load dates”按钮时才会导入 <code>date.js</code> 模块。 <code>date.js</code> 模块导入第三方 <code>moment</code> 模块，该模块仅在 <code>date.js</code> 模块加载时导入。如果用户不需要显示日期，我们可以完全避免加载这个第三方库。</p><p>用户单击“单击加载图像”按钮后，将加载每个图像。图像是本地 <code>.png</code> 文件，根据我们传递给字符串的 <code>num</code> 值加载。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=sb>`../assets/dog</span><span class=si>${</span><span class=nx>num</span><span class=si>}</span><span class=sb>.png`</span><span class=p>);</span>
</span></span></code></pre></div><p>这样，我们就不再依赖于硬编码的模块路径。它为您根据用户输入、从外部源接收的数据、函数结果等导入模块的方式增加了灵活性。</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>通过模块模式，我们可以封装不应该公开的部分代码。这可以防止意外的名称冲突和全局范围污染，从而降低使用多个依赖项和命名空间的风险。为了能够在所有 JavaScript 运行时中使用 ES2015 Module，需要通过类似 Babel 这样的转译器进行转译。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://annachengdesu.github.io/tags/javascript/>Javascript</a></li></ul><nav class=paginav><a class=prev href=https://annachengdesu.github.io/post/patterns/minin-pattern/><span class=title>« Prev</span><br><span>04-Mixin Pattern-设计模式学习-vanilla篇</span></a>
<a class=next href=https://annachengdesu.github.io/post/patterns/mediator-pattern/><span class=title>Next »</span><br><span>03-Mediator/Middleware Pattern-设计模式学习-vanilla篇</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://annachengdesu.github.io/>Anna.me</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>